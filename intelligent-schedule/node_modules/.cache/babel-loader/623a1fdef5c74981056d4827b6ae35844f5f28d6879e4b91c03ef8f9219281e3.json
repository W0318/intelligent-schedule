{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"rules\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, [/*#__PURE__*/_createElementVNode(\"h2\", null, \"关店规则\")], -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"rulesList\"\n};\nconst _hoisted_4 = {\n  class: \"dialog-footer\"\n};\nconst _hoisted_5 = {\n  class: \"dialog-footer\"\n};\nconst _hoisted_6 = {\n  class: \"dialog-footer\"\n};\nconst _hoisted_7 = {\n  class: \"dialog-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_link = _resolveComponent(\"el-link\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_table, {\n    data: $data.tableData,\n    style: {\n      \"width\": \"100%\"\n    },\n    stripe: \"\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_table_column, {\n      label: \"\",\n      prop: \"ruleTitle\"\n    }), _createVNode(_component_el_table_column, {\n      label: \"\",\n      prop: \"ruleValue\"\n    }), _createVNode(_component_el_table_column, {\n      label: \"\"\n    }, {\n      default: _withCtx(scope => [_createVNode(_component_el_link, {\n        size: \"mini\",\n        type: \"primary\",\n        onClick: $event => $options.handleEdit(scope.$index, scope.row)\n      }, {\n        default: _withCtx(() => [_createTextVNode(\" 编辑 \")]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_link, {\n        size: \"mini\",\n        type: \"danger\",\n        onClick: $event => $options.handleDelete(scope.$index, scope.row)\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"删除\")]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"data\"])]), _createCommentVNode(\" 编辑规则对话框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $data.addDialogVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.addDialogVisible = $event),\n    title: \"编辑规则\",\n    width: \"30%\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_4, [_createVNode(_component_el_button, {\n      onClick: _cache[1] || (_cache[1] = $event => $data.addDialogVisible = false)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"取消\")]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $options.handelUpdate\n    }, {\n      default: _withCtx(() => [_createTextVNode(\" 确定 \")]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\"])])]),\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: $data.addForm\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: $data.rulenamee,\n        \"label-width\": \"66%\"\n      }, null, 8 /* PROPS */, [\"label\"]), _createVNode(_component_el_form_item, {\n        label: \"规则内容：\",\n        prop: \"rulevaluee\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: this.rulevaluee,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => this.rulevaluee = $event),\n          placeholder: \"请输入规则内容\",\n          clearable: \"\",\n          style: {\n            width: '100%'\n          }\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 提示框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $data.NoDelete,\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.NoDelete = $event),\n    title: \"无法删除\",\n    width: \"30%\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_5, [_createVNode(_component_el_button, {\n      onClick: _cache[3] || (_cache[3] = $event => $data.NoDelete = false)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"确定\")]),\n      _: 1 /* STABLE */\n    })])]),\n\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: _ctx.deleteForm\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"无法删除通用规则\",\n        \"label-width\": \"66%\",\n        prop: \"nono\"\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 提示框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $data.NoDelete1,\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $data.NoDelete1 = $event),\n    title: \"无法删除\",\n    width: \"30%\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_6, [_createVNode(_component_el_button, {\n      onClick: _cache[5] || (_cache[5] = $event => $data.NoDelete1 = false)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"确定\")]),\n      _: 1 /* STABLE */\n    })])]),\n\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: _ctx.deleteForm1\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"该分店无独立规则，无法进行删除操作\",\n        \"label-width\": \"90%\",\n        prop: \"nono\"\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 提示框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $data.Noemptyy,\n    \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => $data.Noemptyy = $event),\n    title: \"不能为空\",\n    width: \"30%\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_7, [_createVNode(_component_el_button, {\n      onClick: _cache[7] || (_cache[7] = $event => $data.Noemptyy = false)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"确定\")]),\n      _: 1 /* STABLE */\n    })])]),\n\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: _ctx.Noempty\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"输入值不能为空\",\n        \"label-width\": \"66%\",\n        prop: \"nonono\"\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_createVNode","_component_el_table","data","$data","style","stripe","_component_el_table_column","label","prop","scope","_component_el_link","size","type","onClick","$options","$index","row","_createCommentVNode","_component_el_dialog","title","width","footer","_hoisted_4","_component_el_button","_component_el_form","model","_component_el_form_item","_component_el_input","rulevaluee","placeholder","clearable","_hoisted_5","_ctx","_hoisted_6","_hoisted_7"],"sourceRoot":"","sources":["E:\\work\\vue\\schedule\\intelligent-schedule\\src\\views\\ShiftSchedule\\components\\CloseShopRules.vue"],"sourcesContent":["<template>\r\n  <div class=\"rules\">\r\n    <div class=\"title\">\r\n      <h2>关店规则</h2>\r\n    </div>\r\n    <div class=\"rulesList\">\r\n      <el-table :data=\"tableData\" style=\"width: 100%\" stripe>\r\n        <el-table-column label=\"\" prop=\"ruleTitle\"> </el-table-column>\r\n        <el-table-column label=\"\" prop=\"ruleValue\"> </el-table-column>\r\n        <el-table-column label=\"\">\r\n          <template v-slot=\"scope\">\r\n            <el-link\r\n              size=\"mini\"\r\n              type=\"primary\"\r\n              @click=\"handleEdit(scope.$index, scope.row)\"\r\n            >\r\n              编辑\r\n            </el-link>\r\n            <el-link\r\n              size=\"mini\"\r\n              type=\"danger\"\r\n              @click=\"handleDelete(scope.$index, scope.row)\"\r\n              >删除</el-link\r\n            >\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n    <!-- 编辑规则对话框 -->\r\n    <el-dialog v-model=\"addDialogVisible\" title=\"编辑规则\" width=\"30%\">\r\n      <el-form :model=\"addForm\">\r\n        <el-form-item :label=\"rulenamee\" label-width=\"66%\"> </el-form-item>\r\n        <el-form-item label=\"规则内容：\" prop=\"rulevaluee\">\r\n          <el-input\r\n            v-model=\"this.rulevaluee\"\r\n            placeholder=\"请输入规则内容\"\r\n            clearable\r\n            :style=\"{ width: '100%' }\"\r\n          >\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"addDialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"handelUpdate\"> 确定 </el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n    <!-- 提示框 -->\r\n    <el-dialog v-model=\"NoDelete\" title=\"无法删除\" width=\"30%\">\r\n      <el-form :model=\"deleteForm\">\r\n        <el-form-item label=\"无法删除通用规则\" label-width=\"66%\" prop=\"nono\">\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"NoDelete = false\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n    <!-- 提示框 -->\r\n    <el-dialog v-model=\"NoDelete1\" title=\"无法删除\" width=\"30%\">\r\n      <el-form :model=\"deleteForm1\">\r\n        <el-form-item\r\n          label=\"该分店无独立规则，无法进行删除操作\"\r\n          label-width=\"90%\"\r\n          prop=\"nono\"\r\n        >\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"NoDelete1 = false\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n    <!-- 提示框 -->\r\n    <el-dialog v-model=\"Noemptyy\" title=\"不能为空\" width=\"30%\">\r\n      <el-form :model=\"Noempty\">\r\n        <el-form-item label=\"输入值不能为空\" label-width=\"66%\" prop=\"nonono\">\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"Noemptyy = false\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getCloseshopRule,\r\n  updateCloseshop,\r\n  getCloseByStoreId,\r\n  insertClose,\r\n  getAllRule,\r\n  updateCloseByStoreId,\r\n} from \"@/api\";\r\n\r\nexport default {\r\n  inject: [\"reload\"],\r\n  name: \"CloseShop\",\r\n  data() {\r\n    return {\r\n      rulenamee: \"\",\r\n      rulevaluee: \"\",\r\n      label111: -1,\r\n      //修改通用规则则为0，用通用规则但是分店则为1\r\n      label000: 0,\r\n      lengthh: 0,\r\n\r\n      sstr: \"\",\r\n\r\n      tableData: [],\r\n      tableDatas: {\r\n        ruleTitle: \"\",\r\n        ruleValue: \"\",\r\n      },\r\n\r\n      addDialogVisible: false,\r\n      NoDelete: false,\r\n      NoDelete1: false,\r\n      Noemptyy: false,\r\n      addForm: {\r\n        ruleName: \"\",\r\n        ruleContent: \"\",\r\n      },\r\n    };\r\n  },\r\n\r\n  mounted() {\r\n    //获取通用规则\r\n    this.label111 = sessionStorage.getItem(\"label111\");\r\n    if (this.label111 != -1) {\r\n      getCloseByStoreId(this.label111).then((datas) => {\r\n        if (datas.data.length == 0) {\r\n          getCloseshopRule().then((datas) => {\r\n            this.tableData = datas.data;\r\n            let json = JSON.parse(this.tableData[0].ruleValue);\r\n            this.tableData[0].ruleValue = json.position;\r\n            this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n            const rules = {\r\n              ruleTitle: \"关店后清点所需人数公式\",\r\n              ruleValue: json.formula,\r\n            };\r\n            this.tableData.unshift(rules);\r\n            const rules1 = {\r\n              ruleTitle: \"关店后清点所需时间\",\r\n              ruleValue: json.after,\r\n            };\r\n            this.tableData.unshift(rules1);\r\n            console.log(datas.data);\r\n            this.label000 = 1;\r\n          });\r\n        } else if (\r\n          datas.data[0].ruleValue ==\r\n          '{\"after\": \"\", \"formula\": \"\", \"position\": \"\"}'\r\n        ) {\r\n          getCloseshopRule().then((datas) => {\r\n            this.tableData = datas.data;\r\n            let json = JSON.parse(this.tableData[0].ruleValue);\r\n            this.tableData[0].ruleValue = json.position;\r\n            this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n            const rules = {\r\n              ruleTitle: \"关店后清点所需人数公式\",\r\n              ruleValue: json.formula,\r\n            };\r\n            this.tableData.unshift(rules);\r\n            const rules1 = {\r\n              ruleTitle: \"关店后清点所需时间\",\r\n              ruleValue: json.after,\r\n            };\r\n            this.tableData.unshift(rules1);\r\n            console.log(datas.data);\r\n          });\r\n        } else {\r\n          this.tableData = datas.data;\r\n          let json = JSON.parse(this.tableData[0].ruleValue);\r\n          this.tableData[0].ruleValue = json.position;\r\n          this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n          const rules = {\r\n            ruleTitle: \"关店后清点所需人数公式\",\r\n            ruleValue: json.formula,\r\n          };\r\n          this.tableData.unshift(rules);\r\n          const rules1 = {\r\n            ruleTitle: \"关店后清点所需时间\",\r\n            ruleValue: json.after,\r\n          };\r\n          this.tableData.unshift(rules1);\r\n          console.log(datas.data);\r\n        }\r\n      });\r\n    } else if (this.label111 == -1) {\r\n      getCloseshopRule().then((datas) => {\r\n        this.tableData = datas.data;\r\n        let json = JSON.parse(this.tableData[0].ruleValue);\r\n        this.tableData[0].ruleValue = json.position;\r\n        this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n        const rules = {\r\n          ruleTitle: \"关店后清点所需人数公式\",\r\n          ruleValue: json.formula,\r\n        };\r\n        this.tableData.unshift(rules);\r\n        const rules1 = {\r\n          ruleTitle: \"关店后清点所需时间\",\r\n          ruleValue: json.after,\r\n        };\r\n        this.tableData.unshift(rules1);\r\n        console.log(datas.data);\r\n      });\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    handleEdit(index, row) {\r\n      getAllRule().then((datas) => {\r\n        // console.log(datas.data.length);\r\n        console.log(\"label000:\" + this.label000);\r\n        console.log(\"label111:\" + this.label111);\r\n      });\r\n      this.addDialogVisible = true;\r\n      this.rulenamee = this.tableData[index].ruleTitle;\r\n      // console.log(this.rulenamee);\r\n      this.rulevaluee = this.tableData[index].ruleValue;\r\n      // console.log(this.rulevaluee);\r\n    },\r\n\r\n    //删除规则\r\n    async handleDelete(index, row) {\r\n      this.rulenamee = this.tableData[index].ruleTitle;\r\n      if (this.label111 != -1 && this.label000 == 0) {\r\n        if (this.rulenamee == \"关店后清点所需时间\") {\r\n          await getCloseshopRule().then((datass) => {\r\n            this.tableData1 = datass.data;\r\n            console.log(this.tableData1);\r\n            let json = JSON.parse(this.tableData1[0].ruleValue);\r\n            this.sstr =\r\n              '{\"after\": ' +\r\n              json.after +\r\n              ', \"formula\": \"' +\r\n              this.tableData[1].ruleValue +\r\n              '\", \"position\": \"' +\r\n              this.tableData[2].ruleValue +\r\n              '\"}';\r\n            console.log(this.sstr);\r\n          });\r\n        } else if (this.rulenamee == \"关店后清点所需人数公式\") {\r\n          this.sstr =\r\n            '{\"after\": ' +\r\n            this.tableData[0].ruleValue +\r\n            ', \"formula\": \"\", \"position\": \"' +\r\n            this.tableData[2].ruleValue +\r\n            '\"}';\r\n          console.log(this.sstr);\r\n        } else {\r\n          this.sstr =\r\n            '{\"after\": ' +\r\n            this.tableData[0].ruleValue +\r\n            ', \"formula\": \"' +\r\n            this.tableData[1].ruleValue +\r\n            '\", \"position\": \"\"}';\r\n          console.log(this.sstr);\r\n        }\r\n        await updateCloseByStoreId(this.label111, this.sstr);\r\n\r\n        await getCloseByStoreId(this.label111).then((datass) => {\r\n          this.tableData = datass.data;\r\n          let json = JSON.parse(this.tableData[0].ruleValue);\r\n          this.tableData[0].ruleValue = json.position;\r\n          this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n          const rules = {\r\n            ruleTitle: \"关店后清点所需人数公式\",\r\n            ruleValue: json.formula,\r\n          };\r\n          this.tableData.unshift(rules);\r\n          const rules1 = {\r\n            ruleTitle: \"关店后清点所需时间\",\r\n            ruleValue: json.after,\r\n          };\r\n          this.tableData.unshift(rules1);\r\n          console.log(datass.data);\r\n        });\r\n      } else if (this.label111 == -1) {\r\n        this.NoDelete = true;\r\n      } else {\r\n        this.NoDelete1 = true;\r\n      }\r\n    },\r\n\r\n    //点击确认编辑button确认编辑规则\r\n    async handelUpdate() {\r\n      if (this.rulevaluee == \"\") {\r\n        this.Noemptyy = true;\r\n      } else {\r\n        //是分店\r\n        if (this.label111 != -1) {\r\n          //分店无独立规则则插入一条新规则\r\n          if (this.label000 == 1) {\r\n            if (this.rulenamee == \"关店后清点所需时间\") {\r\n              this.sstr =\r\n                '{\"after\": ' +\r\n                this.rulevaluee +\r\n                ', \"formula\": \"' +\r\n                this.tableData[1].ruleValue +\r\n                '\", \"position\": \"' +\r\n                this.tableData[2].ruleValue +\r\n                '\"}';\r\n              console.log(this.sstr);\r\n            } else if (this.rulenamee == \"关店后清点所需人数公式\") {\r\n              this.sstr =\r\n                '{\"after\": ' +\r\n                this.tableData[0].ruleValue +\r\n                ', \"formula\": \"' +\r\n                this.rulevaluee +\r\n                '\", \"position\": \"' +\r\n                this.tableData[2].ruleValue +\r\n                '\"}';\r\n              console.log(this.sstr);\r\n            } else {\r\n              this.sstr =\r\n                '{\"after\": ' +\r\n                this.tableData[0].ruleValue +\r\n                ', \"formula\": \"' +\r\n                this.tableData[1].ruleValue +\r\n                '\", \"position\": \"' +\r\n                this.rulevaluee +\r\n                '\"}';\r\n              console.log(this.sstr);\r\n            }\r\n            getAllRule().then(async (datas) => {\r\n              this.lengthh = datas.data.length + 1;\r\n              this.lengthh = this.lengthh.toString();\r\n              console.log(this.lengthh);\r\n              console.log(this.label111);\r\n              await insertClose(this.lengthh, this.label111, this.sstr);\r\n              this.addDialogVisible = false;\r\n\r\n              await getCloseByStoreId(this.label111).then((datass) => {\r\n                this.tableData = datass.data;\r\n                let json = JSON.parse(this.tableData[0].ruleValue);\r\n                this.tableData[0].ruleValue = json.position;\r\n                this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n                const rules = {\r\n                  ruleTitle: \"关店后清点所需人数公式\",\r\n                  ruleValue: json.formula,\r\n                };\r\n                this.tableData.unshift(rules);\r\n                const rules1 = {\r\n                  ruleTitle: \"关店后清点所需时间\",\r\n                  ruleValue: json.after,\r\n                };\r\n                this.tableData.unshift(rules1);\r\n                console.log(datass.data);\r\n              });\r\n              // this.reload();\r\n            });\r\n          }\r\n          //分店有独立规则则进行编辑（update\r\n          else {\r\n            if (this.rulenamee == \"关店后清点所需时间\") {\r\n              this.sstr =\r\n                '{\"after\": ' +\r\n                this.rulevaluee +\r\n                ', \"formula\": \"' +\r\n                this.tableData[1].ruleValue +\r\n                '\", \"position\": \"' +\r\n                this.tableData[2].ruleValue +\r\n                '\"}';\r\n              console.log(this.sstr);\r\n            } else if (this.rulenamee == \"关店后清点所需人数公式\") {\r\n              this.sstr =\r\n                '{\"after\": ' +\r\n                this.tableData[0].ruleValue +\r\n                ', \"formula\": \"' +\r\n                this.rulevaluee +\r\n                '\", \"position\": \"' +\r\n                this.tableData[2].ruleValue +\r\n                '\"}';\r\n              console.log(this.sstr);\r\n            } else {\r\n              this.sstr =\r\n                '{\"after\": ' +\r\n                this.tableData[0].ruleValue +\r\n                ', \"formula\": \"' +\r\n                this.tableData[1].ruleValue +\r\n                '\", \"position\": \"' +\r\n                this.rulevaluee +\r\n                '\"}';\r\n              console.log(this.sstr);\r\n            }\r\n            await updateCloseByStoreId(this.label111, this.sstr);\r\n            this.addDialogVisible = false;\r\n\r\n            await getCloseByStoreId(this.label111).then((datass) => {\r\n              this.tableData = datass.data;\r\n              let json = JSON.parse(this.tableData[0].ruleValue);\r\n              this.tableData[0].ruleValue = json.position;\r\n              this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n              const rules = {\r\n                ruleTitle: \"关店后清点所需人数公式\",\r\n                ruleValue: json.formula,\r\n              };\r\n              this.tableData.unshift(rules);\r\n              const rules1 = {\r\n                ruleTitle: \"关店后清点所需时间\",\r\n                ruleValue: json.after,\r\n              };\r\n              this.tableData.unshift(rules1);\r\n              console.log(datass.data);\r\n            });\r\n            // this.reload();\r\n          }\r\n        }\r\n        //不是分店\r\n        else {\r\n          if (this.rulenamee == \"关店后清点所需时间\") {\r\n            this.sstr =\r\n              '{\"after\": ' +\r\n              this.rulevaluee +\r\n              ', \"formula\": \"' +\r\n              this.tableData[1].ruleValue +\r\n              '\", \"position\": \"' +\r\n              this.tableData[2].ruleValue +\r\n              '\"}';\r\n            console.log(this.sstr);\r\n          } else if (this.rulenamee == \"关店后清点所需人数公式\") {\r\n            this.sstr =\r\n              '{\"after\": ' +\r\n              this.tableData[0].ruleValue +\r\n              ', \"formula\": \"' +\r\n              this.rulevaluee +\r\n              '\", \"position\": \"' +\r\n              this.tableData[2].ruleValue +\r\n              '\"}';\r\n            console.log(this.sstr);\r\n          } else {\r\n            this.sstr =\r\n              '{\"after\": ' +\r\n              this.tableData[0].ruleValue +\r\n              ', \"formula\": \"' +\r\n              this.tableData[1].ruleValue +\r\n              '\", \"position\": \"' +\r\n              this.rulevaluee +\r\n              '\"}';\r\n            console.log(this.sstr);\r\n          }\r\n          console.log(this.rulevaluee);\r\n          await updateCloseshop(this.sstr);\r\n          this.addDialogVisible = false;\r\n\r\n          await getCloseshopRule().then((datass) => {\r\n            this.tableData = datass.data;\r\n            let json = JSON.parse(this.tableData[0].ruleValue);\r\n            this.tableData[0].ruleValue = json.position;\r\n            this.tableData[0].ruleTitle = \"关店后清点员工限定职位（数组）\";\r\n            const rules = {\r\n              ruleTitle: \"关店后清点所需人数公式\",\r\n              ruleValue: json.formula,\r\n            };\r\n            this.tableData.unshift(rules);\r\n            const rules1 = {\r\n              ruleTitle: \"关店后清点所需时间\",\r\n              ruleValue: json.after,\r\n            };\r\n            this.tableData.unshift(rules1);\r\n            console.log(datass.data);\r\n          });\r\n          // this.reload();\r\n        }\r\n      }\r\n    },\r\n\r\n    getCloseshopRules() {\r\n      getCloseshopRule().then((datas) => {\r\n        this.tableData.ruleId = datas.data[0].ruleTitle;\r\n        console.log(datas.data);\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.el-link {\r\n  margin-left: 17px;\r\n}\r\n\r\n.rules {\r\n  .title {\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n  .rulesList {\r\n    margin-top: 20px;\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}